{% extends 'main.html' %}

{% block content %}

{% include 'status.html' %}


<div class="col-sm-12">
  {% if IsAdmin or newuserPermission.battery.create %}
    <a href="{% url 'addbattery' %}" class="btn btn-info btn-sm">Add-Battery-Data</a>
  {% endif %}

    <a href="{% url 'home' %}" class="btn btn-secondary btn-sm">Home</a>
    <h4 class="text-center alert alert info">Battery Data</h4>
    <div>
    <form action="" method="GET">
      
      {% if messages %}
        {% for message in messages %}
        <div class = "alert alert-{{message.tags}}">{{message}}</div>
        {% endfor %}
      {% endif %}

        {% if battery_data %}
       
                <table class="table table-hover">
                    <thead>
                      <tr>
                        <th scope="col">Assigned Battery</th>
                        <th scope="col">Model name</th>
                        <th scope="col">Battery serial num</th>
                        <th scope="col">Battery type</th>
                        <th scope="col">Bms type</th>
                        <th scope="col">Iot type</th>
                        <th scope="col">Sim Number</th>
                        <th scope="col">Warrenty start date</th>
                        <th scope="col">warrenty duration</th>
                        <th scope="col">Status</th>
                        <th scope="col">Battery cell chemistry</th>
                        <th scope="col">Battery pack nominalvoltage</th>
                        <th scope="col">Battery pack capacity</th>
                        <th scope="col">charging status</th>
                        <th scope="col">Action</th>
                        
                      </tr>
                    <tbody>
    
                    {% for fm in battery_data %}
                      <tr>
                        <td>
                          {% if fm.is_assigned %}
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" checked="checked" value="{{fm}}" name="is_assigned">
                          </div>
                          {% else %}
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="{{fm}}" name="is_assigned">
                          </div>
                          {% endif %}
                        </td>
                        <td>{{fm.model_name}}</td>
                        <td>{{fm.battery_serial_num}}</td>
                        <td>{{fm.battery_type}}</td>
                        <td>{{fm.bms_type}}</td>
                        <td>{{fm.iot_type}}</td>
                        <td>{{fm.sim_number}}</td>
                        <td>{{fm.warrenty_start_date}}</td>
                        <td>{{fm.warrenty_duration}}</td>
                        <td>{{fm.status}}</td>
                        <td>{{fm.battery_cell_chemistry}}</td>
                        <td>{{fm.battery_pack_nominal_voltage}}</td>
                        <td>{{fm.battery_pack_capacity}}</td>
                        <td>{{fm.charging_status}}</td>
                        <td style="display: flex;">
                          <a class="table-link" aria-expanded="false" href="{% url 'battery_data' %}"><img src="../static/icons/data-update.svg"/></a>

                        {% if IsAdmin or newuserPermission.battery.update %}
                          <a class="table-link" aria-expanded="false" href="{% url 'updatedata' fm.battery_serial_num %}"><img src="../static/icons/edit.svg"></a>

                        {% endif%}
                        {% if IsAdmin or newuserPermission.battery.delete %}
                        <a class="table-link" aria-expanded="false" href="{% url 'deletedata' fm.battery_serial_num %}"><img src="../static/icons/delete.svg"></a>

                        {% endif%}
                        {% if IsAdmin or newuserPermission.battery.batteryAssigned %}
                              <a href="{% url 'assingedtovehicle' %}?battery_serial_num={{fm.battery_serial_num}}&action='add'" class="btn btn-secondary btn-sm">assign to vehicle</a>
                        {% endif%}
                          <a  href="{% url 'iramedata' fm.battery_serial_num %}" style="height:100%; width: 100%;"  aria-expanded="false" class="btn btn-secondary btn-sm">Battery Packs</a> 
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                    </thead>
                  </table>
                
        {% else %}
            <h4 class="text-center alert alert warning">No Data Found</h4>
        {% endif %}

    </form>  
  </div>
</div>


{% endblock %}